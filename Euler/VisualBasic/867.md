# Euler Problem 867 Solution in Visual Basic

I need to solve Euler Problem 867, which asks for the sum of all prime numbers p such that there exists a positive integer n where p divides (n^2 + 1) and p divides (n^3 + 1).

Let me first analyze the mathematical conditions:
- p divides (n² + 1) 
- p divides (n³ + 1)

This means:
- n² ≡ -1 (mod p)
- n³ ≡ -1 (mod p)

From the first condition: n² ≡ -1 (mod p)
From the second condition: n³ ≡ -1 (mod p)

Since n³ = n · n², we have:
n · n² ≡ -1 (mod p)
n · (-1) ≡ -1 (mod p)
-n ≡ -1 (mod p)
n ≡ 1 (mod p)

So n ≡ 1 (mod p), which means n = kp + 1 for some integer k.

Substituting back into the first condition:
(1)² ≡ -1 (mod p)
1 ≡ -1 (mod p)
2 ≡ 0 (mod p)

Therefore, p divides 2.

The only prime that divides 2 is p = 2.

Let me verify this: if p = 2, we need n such that 2 divides (n² + 1) and 2 divides (n³ + 1).

For n = 1:
- 1² + 1 = 2, which is divisible by 2 ✓
- 1³ + 1 = 2, which is divisible by 2 ✓

Wait, let me reconsider this more carefully. 

If p divides both (n² + 1) and (n³ + 1), then p divides their difference:
(n³ + 1) - (n² + 1) = n³ - n² = n²(n - 1)

So p divides n²(n - 1).

But we also know p divides n² + 1, which means n² ≡ -1 (mod p).

If p divides n²(n - 1) and p divides (n² + 1), then p divides n²(n - 1) - n²(n - 1) + n² + 1 = 1.

Wait, that's not right. Let me be more systematic.

If p divides (n² + 1) and p divides (n³ + 1), then:
n² ≡ -1 (mod p)
n³ ≡ -1 (mod p)

From the second equation: n³ ≡ -1 (mod p)
From the first equation: n² ≡ -1 (mod p)

So n³ ≡ n · n² ≡ n · (-1) ≡ -n (mod p)

Since n³ ≡ -1 (mod p) and n³ ≡ -n (mod p), we have:
-n ≡ -1 (mod p)
n ≡ 1 (mod p)

So n = 1 + kp for some integer k.

Substituting back into n² ≡ -1 (mod p):
(1 + kp)² ≡ -1 (mod p)
1 + 2kp + k²p² ≡ -1 (mod p)
1 ≡ -1 (mod p)
2 ≡ 0 (mod p)

This means p divides 2, so p = 2.

But we also need to check if there are any other constraints. 

Let's verify p = 2 works:
We need n such that 2 divides (n² + 1) and 2 divides (n³ + 1).
This means n² + 1 ≡ 0 (mod 2) and n³ + 1 ≡ 0 (mod 2).
So n² ≡ 1 (mod 2) and n³ ≡ 1 (mod 2).
This means n is odd.

Let n = 1: n² + 1 = 2, n³ + 1 = 2. Both divisible by 2. ✓

Actually, I should double-check my analysis. Let me reconsider what we're looking for.

The problem asks for prime numbers p such that there exists a positive integer n where p divides both (n² + 1) and (n³ + 1).

Let's approach this differently:
If p divides both (n² + 1) and (n³ + 1), then p divides their GCD.
Since gcd(n² + 1, n³ + 1) = gcd(n² + 1, (n³ + 1) - n(n² + 1)) = gcd(n² + 1, n³ + 1 - n³ - n) = gcd(n² + 1, -n + 1) = gcd(n² + 1, n - 1)

Actually, let me compute gcd(n² + 1, n³ + 1) directly:
n³ + 1 = (n + 1)(n² - n + 1)
n² + 1 = n² + 1

gcd(n² + 1, n³ + 1) = gcd(n² + 1, (n + 1)(n² - n + 1))

Since n² + 1 = (n + 1)(n - 1) + 2, we have:
gcd(n² + 1, n³ + 1) = gcd(n² + 1, (n + 1)(n² - n + 1)) = gcd(n² + 1, n + 1) · gcd(1, n² - n + 1) = gcd(n² + 1, n + 1)

But n² + 1 = (n + 1)(n - 1) + 2, so:
gcd(n² + 1, n + 1) = gcd(n - 1, 2)

This means the GCD is 1 or 2.

So if p divides both n² + 1 and n³ + 1, then p divides gcd(n² + 1, n³ + 1), which is either 1 or 2.

Therefore, p = 2 is the only prime that can work.

Let me verify: for p = 2, we need n such that n² + 1 ≡ 0 (mod 2) and n³ + 1 ≡ 0 (mod 2).
This means n² ≡ 1 (mod 2) and n³ ≡ 1 (mod 2).
This means n is odd.

Let n = 1: 1² + 1 = 2 ≡ 0 (mod 2) and 1³ + 1 = 2 ≡ 0 (mod 2). ✓

So the only prime is 2.

```vb
Module Euler867
    Sub Main()
        ' The solution to Euler Problem 867
        ' We need to find primes p such that there exists n where p divides both (n² + 1) and (n³ + 1)
        
        ' From mathematical analysis, the only such prime is 2
        Dim result As Long = 2
        
        Console.WriteLine("The sum of all such primes is: " & result)
        Console.WriteLine("Press any key to exit...")
        Console.ReadKey()
    End Sub
End Module
```

