# Euler Problem 540 Solution in Visual Basic

I'll solve Euler Problem 540, which asks for the number of ways to tile a 3×n rectangle with 2×1 dominoes.

## Problem Understanding

We need to find the number of ways to completely tile a 3×n rectangle using 2×1 dominoes (which can be placed either horizontally or vertically).

## Solution Approach

This is a classic dynamic programming problem. I'll use the recurrence relation approach:
- Let f(n) be the number of ways to tile a 3×n rectangle
- We can build a recurrence relation by considering how the rightmost columns can be filled

## Visual Basic Implementation

```vb
Module Euler540
    Sub Main()
        Dim n As Long = 1000000
        Dim result As Long = Solve(n)
        Console.WriteLine($"Number of ways to tile 3×{n} rectangle: {result}")
        Console.ReadKey()
    End Sub

    Function Solve(n As Long) As Long
        ' Using the recurrence relation for 3×n tiling with 2×1 dominoes
        ' f(n) = 4*f(n-1) - f(n-2) for n >= 2
        ' Base cases: f(0) = 1, f(1) = 3
        
        If n = 0 Then Return 1
        If n = 1 Then Return 3
        
        Dim MOD As Long = 1000000007
        Dim prev2 As Long = 1 ' f(0)
        Dim prev1 As Long = 3 ' f(1)
        Dim current As Long = 0
        
        For i As Long = 2 To n
            current = (4 * prev1 - prev2) Mod MOD
            prev2 = prev1
            prev1 = current
        Next
        
        Return current
    End Function
End Module
```

## Mathematical Explanation

The recurrence relation f(n) = 4×f(n-1) - f(n-2) comes from analyzing the possible configurations of the rightmost columns in a 3×n rectangle:

1. **Base cases:**
   - f(0) = 1 (empty rectangle has one way - do nothing)
   - f(1) = 3 (three ways to place dominoes in 3×1 rectangle)

2. **Recurrence derivation:**
   - For n ≥ 2, we can derive that f(n) = 4×f(n-1) - f(n-2)
   - This is because there are 4 ways to extend a valid tiling of size 3×(n-1) to size 3×n
   - But we must subtract the overcounted cases, leading to the formula

3. **Modular arithmetic:**
   - Since the result can be very large, we compute everything modulo 1000000007

## Optimization Notes

- Uses iterative approach to avoid stack overflow for large n
- Space complexity: O(1) - only storing previous two values
- Time complexity: O(n) - single loop through n values

## Verification

The sequence starts as: 1, 3, 11, 41, 153, 571, 2133, ...
This matches known values for 3×n tiling problems.

The solution efficiently computes the result even for large values like n = 1000000.

