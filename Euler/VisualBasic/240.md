# Euler Problem 240 Solution in Visual Basic

This problem asks for the number of ways to roll exactly 20 dice with values 1-6 such that the sum equals 30, with exactly 3 dice showing value 6.

Let me break down the approach:
1. We have 20 dice total
2. Exactly 3 dice must show value 6
3. The remaining 17 dice must sum to 30 - 3×6 = 12
4. Each of the remaining dice can show values 1-5

```vb
Module Problem240
    Sub Main()
        Dim result As Long = Solve()
        Console.WriteLine("Answer: " & result)
        Console.ReadKey()
    End Sub
    
    Function Solve() As Long
        Dim totalWays As Long = 0
        
        ' We need exactly 3 dice showing 6
        ' The remaining 17 dice must sum to 12
        ' Each of these 17 dice can be 1,2,3,4,5
        
        ' Choose 3 positions out of 20 for the 6s
        Dim combinations As Long = Choose(20, 3)
        
        ' For each way to place the 6s, count valid combinations for remaining dice
        Dim waysToGetSum As Long = CountWaysToGetSum(17, 12, 5)
        
        Return combinations * waysToGetSum
    End Function
    
    ' Calculate C(n,k) = n! / (k! * (n-k)!)
    Function Choose(n As Integer, k As Integer) As Long
        If k > n Or k < 0 Then Return 0
        If k = 0 Or k = n Then Return 1
        
        ' Use the smaller of k and n-k to minimize calculations
        k = Math.Min(k, n - k)
        
        Dim result As Long = 1
        For i As Integer = 1 To k
            result = result * (n - i + 1) \ i
        Next
        
        Return result
    End Function
    
    ' Count number of ways to get sum with n dice, each having max value maxVal
    Function CountWaysToGetSum(n As Integer, targetSum As Integer, maxVal As Integer) As Long
        ' This is a dynamic programming approach
        Dim dp(200, 20) As Long ' dp[sum, dice] = number of ways
        
        ' Base case: 0 dice, sum 0 = 1 way (empty)
        dp(0, 0) = 1
        
        ' Fill the dp table
        For dice As Integer = 1 To n
            For sum As Integer = 0 To targetSum
                ' Try all possible values for the current die (1 to maxVal)
                For value As Integer = 1 To Math.Min(maxVal, sum)
                    If sum - value >= 0 AndAlso dice - 1 >= 0 Then
                        dp(sum, dice) += dp(sum - value, dice - 1)
                    End If
                Next
            Next
        Next
        
        Return dp(targetSum, n)
    End Function
End Module
```

Wait, let me reconsider the problem more carefully. I need to think about this differently.

```vb
Module Problem240
    Sub Main()
        Dim result As Long = Solve()
        Console.WriteLine("Answer: " & result)
        Console.ReadKey()
    End Sub
    
    Function Solve() As Long
        ' We have 20 dice, exactly 3 must show 6
        ' Remaining 17 dice must sum to 12 (since 30 - 3×6 = 12)
        ' Each of remaining dice shows 1,2,3,4,5
        
        ' Step 1: Choose 3 positions out of 20 for the 6s
        Dim positions As Long = Choose(20, 3)
        
        ' Step 2: Count ways to make sum 12 with 17 dice, each showing 1-5
        Dim validCombinations As Long = CountWays(17, 12, 5)
        
        Return positions * validCombinations
    End Function
    
    ' Calculate combination C(n,k)
    Function Choose(n As Integer, k As Integer) As Long
        If k > n Or k < 0 Then Return 0
        If k = 0 Or k = n Then Return 1
        If k > n - k Then k = n - k
        
        Dim result As Long = 1
        For i As Integer = 1 To k
            result = result * (n - i + 1) \ i
        Next
        Return result
    End Function
    
    ' Count ways to get target sum with n dice, each die showing 1 to maxVal
    Function CountWays(n As Integer, targetSum As Integer, maxVal As Integer) As Long
        ' dp[i, j] = number of ways to get sum j with i dice
        Dim dp(200, 20) As Long
        
        ' Base case
        dp(0, 0) = 1
        
        ' Fill DP table
        For i As Integer = 1 To n
            For j As Integer = 0 To targetSum
                For k As Integer = 1 To Math.Min(maxVal, j)
                    If j - k >= 0 Then
                        dp(j, i) += dp(j - k, i - 1)
                    End If
                Next
            Next
        Next
        
        Return dp(targetSum, n)
    End Function
End Module
```

